<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Animation Logo</title>
  <!-- Préchargement des images -->
  <link rel="prefetch" href="/settings-icon.heic">
  <link rel="prefetch" href="/icon.png">
  <link rel="prefetch" href="/XP_2.png">
  <link rel="prefetch" href="/verification_maj.png">
  <link rel="prefetch" href="/Willy.html">
  <link rel="prefetch" href="/Doudou.html">
  <link rel="prefetch" href="/Cocobi.html">
  <link rel="prefetch" href="/Oiseau.html">
  <link rel="prefetch" href="/Grours.html">
  <link rel="prefetch" href="/Baleine.html">
  <link rel="prefetch" href="/Diva.html">
  <link rel="prefetch" href="/Poulpy.html">
  <link rel="prefetch" href="/Coeur.html">
  <link rel="prefetch" href="/Colorina.html">
  <link rel="prefetch" href="/Potion-1.png">
  <link rel="prefetch" href="/Amulette-1.png">
  <link rel="prefetch" href="/recompenses.html">
  <link rel="prefetch" href="/gratuite-rec.png">
  <link rel="prefetch" href="/armure-1.png">
  <link rel="prefetch" href="/elixir-1.png">
  <link rel="prefetch" href="/epee-1.png">
  <link rel="prefetch" href="/quetes.html">
  <link rel="prefetch" href="/Icon-menu.png">
  <link rel="prefetch" href="/Icon-parametre.png">
  <link rel="prefetch" href="/Icon-personnage.png">
  <link rel="prefetch" href="/Icon-magazin.png">
  <link rel="prefetch" href="/Icon-amelioration.png">
  <link rel="prefetch" href="/trophy-icon-3.png">
  <link rel="prefetch" href="/user-icon.png">
  <link rel="prefetch" href="/fin_partie_survie.html">
  <link rel="prefetch" href="/combat-survie.html">
  <link rel="prefetch" href="/special.png">
  <link rel="prefetch" href="/attaque.png">
  <link rel="prefetch" href="/inventaire.png">
  <link rel="prefetch" href="/defense.png">
  <link rel="prefetch" href="/actualites.html">
  <link rel="prefetch" href="/passe_fond.jpeg">
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      /* Ajustement de la hauteur du body */
      margin: 0;
      background: radial-gradient(circle, #e0e0e0, #b0b0b0);
      overflow: hidden;
      perspective: 1000px;
    }

    #container {
      position: absolute;
      /* Position absolue pour centrer le conteneur */
      width: 150px;
      height: 150px;
      background-color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      animation: drop 1s ease forwards, fadeAndLift 2s ease 3s forwards;
      transform-origin: top;
      border-radius: 20px;
      box-shadow: 0 0 0 rgba(0, 0, 0, 0.2);
    }

    #logo {
      font-size: 100px;
      color: #fff;
      font-weight: bold;
      transform: scale(0);
      animation: growAndShine 2s ease forwards 1s;
    }

    @keyframes drop {
      0% {
        transform: translateY(-100vh) scale(0.5) rotateX(90deg);
        opacity: 0;
        box-shadow: 0 0 0 rgba(0, 0, 0, 0.0);
      }

      50% {
        transform: translateY(0) scale(1.2) rotateX(45deg);
        opacity: 1;
        box-shadow: 0 20px 30px rgba(0, 0, 0, 0.8);
      }

      100% {
        transform: translateY(0) scale(1) rotateX(0);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }
    }

    @keyframes growAndShine {
      0% {
        transform: scale(0);
        filter: brightness(1);
      }

      50% {
        transform: scale(1.5);
        filter: brightness(2);
      }

      100% {
        transform: scale(1);
        filter: brightness(1);
      }
    }

    @keyframes fadeAndLift {
      0% {
        background: linear-gradient(to bottom, #333 0%, #333 100%);
        opacity: 1;
        transform: translateY(0);
      }

      100% {
        background: linear-gradient(to bottom, #333 0%, #e0e0e0 100%);
        opacity: 0;
        transform: translateY(-150px);
      }
    }
  </style>
  <link rel="manifest" href="/manifest.json">
</head>

<body>
  <div id="container">
    <div id="logo">S</div>
  </div>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').then((registration) => {
          console.log('Service Worker registered with scope:', registration.scope);

          // Demander la permission pour les notifications
          Notification.requestPermission().then((permission) => {
            if (permission === 'granted') {
              console.log('Notification permission granted.');
            } else {
              console.log('Notification permission denied.');
            }
          });

        }).catch((error) => {
          console.log('Service Worker registration failed:', error);
        });
      });
    }
  </script>
  <script type="module">
    // Importation des modules Firebase
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
    import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js';
    import { getPerformance } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-performance.js';

    // Configuration Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAwIIKfoYwdtFD63yKhVggZOAnooQion-M",
      authDomain: "willy0s-parallel-arena.firebaseapp.com",
      databaseURL: "https://willy0s-parallel-arena-default-rtdb.firebaseio.com",
      projectId: "willy0s-parallel-arena",
      storageBucket: "willy0s-parallel-arena.appspot.com",
      messagingSenderId: "683284732830",
      appId: "1:683284732830:web:ef7fb4cf1c88f73eead48f",
      measurementId: "G-85B8R4NKNM"
    };

    // Initialisation de Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Initialisation de Firebase Performance Monitoring
    const perf = getPerformance(app);
    if ('PerformanceObserver' in window) {
      // Créer un observateur pour les entrées de type "paint" (pour FCP)
      const paintObserver = new PerformanceObserver((list) => {
        const entries = list.getEntriesByName('first-contentful-paint');
        if (entries.length > 0) {
          const fcp = entries[0].startTime;
          console.log('First Contentful Paint (FCP):', fcp, 'ms');
        }
      });

      // Observer les événements de type "paint"
      paintObserver.observe({ type: 'paint', buffered: true });

      // Créer un observateur pour les entrées de type "first-input" (pour FID)
      const fidObserver = new PerformanceObserver((list) => {
        const entries = list.getEntries();
        entries.forEach((entry) => {
          if (entry.entryType === 'first-input') {
            const fid = entry.processingStart - entry.startTime;
            console.log('First Input Delay (FID):', fid, 'ms');
          }
        });
      });

      // Observer les événements de type "first-input"
      fidObserver.observe({ type: 'first-input', buffered: true });
    }

    // Référence à l'état de maintenance dans la base de données
    const maintenanceRef = ref(database, 'maintenance');

    // Écoute des changements de l'état de maintenance
    onValue(maintenanceRef, (snapshot) => {
      const data = snapshot.val();
      const maintenanceActive = data.active === 'oui';
      const maintenanceTime = data.heure;

      if (maintenanceActive && maintenanceTime) {
        const [maintenanceHour, maintenanceMinute] = maintenanceTime.split(':').map(Number);
        const currentTime = new Date();
        const currentHour = currentTime.getHours();
        const currentMinute = currentTime.getMinutes();

        // Vérifier si l'heure de maintenance est plus tard que l'heure actuelle
        if (maintenanceHour > currentHour || (maintenanceHour === currentHour && maintenanceMinute > currentMinute)) {
          // Rediriger après la première partie de l'animation
          document.getElementById('container').addEventListener('animationend', function (event) {
            if (event.animationName === 'fadeAndLift') {
              window.location.href = 'maintenance.html';
            }
          });
        } else {
          // Rediriger vers le menu principal si la maintenance n'est pas active ou l'heure est passée
          document.getElementById('container').addEventListener('animationend', function (event) {
            if (event.animationName === 'fadeAndLift') {
              window.location.href = 'menu_principal.html';
            }
          });
        }
      }
    });
  </script>
  <script>
    document.getElementById('container').addEventListener('animationend', function (event) {
      if (event.animationName === 'fadeAndLift') {
        window.location.href = 'menu_principal.html';
      }
    });
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').then((registration) => {
          console.log('Service Worker registered with scope:', registration.scope);
        }).catch((error) => {
          console.log('Service Worker registration failed:', error);
        });
      });
    }
    function getUserConnect() {
      let userConnect = localStorage.getItem('userConnect');
      if (!userConnect) {
        userConnect = {
          est_connecte: false,
          userid: "",
        };
        localStorage.setItem('userConnect', JSON.stringify(userConnect));
      };
    }
    function getUserData() {
      let userData = localStorage.getItem('userData');
      if (!userData) {
        // Initialiser les données utilisateur si elles n'existent pas encore
        userData = {
          est_connecte: false,
          userid: "",
          pass_XP: 0,
          pass_level: 0,
          nbr_perso: 2,
          victoires: 0,
          defaites: 0,
          manches_max: 0,
          XP_jour: 0,
          gagnant: '',
          fin_manche: 0,
          fin_xp: 0,
          fin_argent: 0,
          fin_trophees: 0,
          trophees: 0,
          argent: 0,
          VICTOIRE: false,
          version: '2.4.1',
          recompense: 0,
          perso_recompense: 0,
          xp_du_jour: 0,
          Willy: 1,
          Willy_XP: 0,
          Willy_Level: 1,
          Willy_boost: 0,
          Cocobi: 1,
          Cocobi_XP: 0,
          Cocobi_Level: 1,
          Cocobi_boost: 0,
          Oiseau: 0,
          Oiseau_XP: 0,
          Oiseau_Level: 1,
          Oiseau_boost: 0,
          Grours: 0,
          Grours_XP: 0,
          Grours_Level: 1,
          Grours_boost: 0,
          Baleine: 0,
          Baleine_XP: 0,
          Baleine_Level: 1,
          Baleine_boost: 0,
          Doudou: 0,
          Doudou_XP: 0,
          Doudou_Level: 1,
          Doudou_boost: 0,
          Coeur: 0,
          Coeur_XP: 0,
          Coeur_Level: 1,
          Coeur_boost: 0,
          Diva: 0,
          Diva_XP: 0,
          Diva_Level: 1,
          Diva_boost: 0,
          Poulpy: 0,
          Poulpy_XP: 0,
          Poulpy_Level: 1,
          Poulpy_boost: 0,
          Colorina: 0,
          Colorina_XP: 0,
          Colorina_Level: 1,
          Colorina_boost: 0,
          Rosalie: 0,
          Rosalie_XP: 0,
          Rosalie_Level: 1,
          Rosalie_boost: 0,
          Sboonie: 0,
          Sboonie_XP: 0,
          Sboonie_Level: 1,
          Sboonie_boost: 0,
          Double_XP: 5,
          Double_XP_acheté: 0,
          Potion_de_Santé_acheté: 0,
          Amulette_de_Régénération_acheté: 0,
          epee_tranchante_acheté: 0,
          elixir_puissance_acheté: 0,
          armure_fer_acheté: 0,
          bouclier_solide_acheté: 0,
          lastDoubleXPCheck: 0,
          lastFraudeReset: 0,
          boutique_recompense: false,

          semaine1: false,


          semaine2: false,


          semaine3: false,


          semaine4: false,



          semaine5: false,

          semaine6: false,

          crystaux_parrallels: 0,

          quetes_jour: false,

          quete1_type: "",
          quete1_text: "",
          quete1_total: "",
          quete1_current: "",
          quete1_character: "",

          quete2_type: "",
          quete2_text: "",
          quete2_total: "",
          quete2_current: "",
          quete2_character: "",

          quete3_type: "",
          quete3_text: "",
          quete3_total: "",
          quete3_current: "",
          quete3_character: "",

          partie_commencee: false,
        };

        localStorage.setItem('userData', JSON.stringify(userData));
      }
    };
    getUserData();
    getUserConnect();
  </script>


</body>

</html>